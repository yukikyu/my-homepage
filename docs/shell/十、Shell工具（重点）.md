# 十、Shell工具（重点）

## 1.cut

cut的工作就是“剪”，具体的说就是在文件中负责剪切数据用的。cut命令从文件的每一行剪切字节、字符和字段并将这些字节、字符和字段输出。

### 1.1.基本用法

```bash
$ cut [选择参数] filename
```

> 默认分隔符是制表符
> 

### 1.2.选项参数说明

| 选项参数 | 功能 |
| --- | --- |
| -f | 列号，提取第几列 |
| -d | 分隔符，按照指定分隔符分割列 |

### 1.3.案例实操

- 数据准备
    
    ```bash
    $ touch cut.txt
    $ vim cut.txt
    ~11 12
    22 23
    33  34
    44  45
    ```
    
- 切割cut.txt第一列
    
    ```bash
    $ cut -d " " -f 1 cut.txt
    11
    22
    33
    44
    ```
    
- 切割 cut.txt 第二、三列
    
    ```bash
    $ cut -d " " -f 2,3 cut.txt
    12
    23
     34
     45
    ```
    
- 在 cut.txt 文件中切割出12
    
    ```bash
    $ cat cut.txt | grep "12" | cut -d " " -f 1
    12
    ```
    
- 选取系统PATH变量，第二个“：”开始后的所有路径：
    
    ```bash
    $ echo $PATH | cut -d : -f 2-
    ```
    
- 切割ifconfig后打印的IP地址
    
    ```bash
    $ ifconfig eth0 | grep "inet addr" | cut -d: -f 2 | cut -d" " -f1
    192.168.1.102
    ```
    

## 2.sed

sed是一个流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”，接着用sed命令处理缓冲区的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。

### 2.1.基本用法

```bash
$ sed [选择参数] ‘command’ filename
```

### 2.2.选择参数说明

| 选择参数 | 功能 |
| --- | --- |
| -e | 直接在指令列模式上进行sed的动作编辑 |

### 2.3.命令功能描述

| 命令 | 功能描述 |
| --- | --- |
| a |   新增，a的后面可以接字符串，在下一行出现 |
| d | 删除 |
| s | 查找并替换 |

### 2.4.案例实操

- 数据准备
    
    ```bash
    $ touch sed.txt
    $ vim sed.txt
    ~11 12
    22 23
    33 34
    44 45
    ```
    
- 将“45678”这个单词插入到sed.txt第二行下，打印。
    
    ```bash
    $ sed "2a 45678" sed.txt
    11 12
    22 23
    45678
    33 34
    44 45
    ```
    
    > 文件没有改变
    > 
- 删除sed.txt文件所有包含22的行
    
    ```bash
    $ sed "/22/d" sed.txt
    11 12
    33 34
    44 45
    ```
    
- 将sed.txt文件中22替换为88
    
    ```bash
    $ sed "s/22/88/g" sed.txt
    11 12
    88 23
    33 34
    44 45
    ```
    
    > “g”表示global，全部替换
    > 
- 将sed.txt文件中第三行删除并将22替换为88
    
    ```bash
    $ sed -e "2d" -e "s/22/88/g" sed.txt
    11 12
    88 23
    44 45
    ```
    

## 3.awk

一个强大的文本分析工具，把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行分析处理。

### 3.1.基本用法

```bash
awk [选项参数] ‘pattern1{action1} pattern2{action2} ’ filename
# pattern：表示AWK在数据中查找的内容，就是匹配模式
# action：在找到匹配内容时所执行的一系列命令
```

### 3.2.选项参数说明

| 选项参数 | 功能 |
| --- | --- |
| -F | 指定输入文件折分隔符 |
| -v | 赋值一个用户定义变量 |

### 3.3.案例实操

- 数据准备
    
    ```bash
    $ sudo cp /etc/password ./
    ```
    
- 搜索passwd文件以root关键字开头的所有行，并输出该行的第7列，中间以“,”分割。
    
    ```bash
    $ awk -F: '/^root/{print $1","$7}'
    pwsswd
    root,/bin/bash
    ```
    
    > 只有匹配了pattem的行才会执行action
    > 
- 只显示/etc/passwd的第一列和第七列，以逗号分隔，且在所有行前面添加列名user，shell在最后一行添加“aa,bb”。
    
    ```bash
    $ awk -F : 'BEGIN{print "user,shell"}'
    ```